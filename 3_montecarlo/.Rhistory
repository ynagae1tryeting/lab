}
Etotal <- numA * myuA + numB * myuB + numC * myuC
test <- pforeach (i=1:k, .combine='rbind')({
pforeach(j=1:k, .combine='cbind')({
cell[i,j]
})
})
k <- 20
cell <- matrix(-1, nrow=k^2)
samp <- sample(1:k^2, k^2*0.075)  # --- 7.5%のSnを導入
cell[samp] <- 0 # --- サンプリングした番号にSi-Snペアを入れる
cell <- matrix(cell,nrow=k,ncol=k)
# --- 0K におけるHFE
myuA <- -35.441254 / 4
myuB <- -42.913069 / 4
myuC <- -30.486315 / 4
numA <- table(cell==0)
numA <- as.numeric(numA["TRUE"])
numB <- table(cell==-1)
numB <- as.numeric(numB["TRUE"])
numC <- table(cell==1)
numC <- as.numeric(numC["TRUE"])
if (is.na(numA)) {
numA <- 0
}
if (is.na(numB)){
numB <- 0
}
if (is.na(numC)){
numC <- 0
}
Etotal <- numA * myuA + numB * myuB + numC * myuC
print(cell)
image(cell)
x <- k*(1:nrow(cell));   y <- k*(1:ncol(cell))
image(x, y, cell, col = terrain.colors(100), axes = T)
image(x, y, cell, col = terrain.colors(50), axes = T)
image(x, y, cell, col = terrain.colors(50), axes = T)
image(x, y, cell, col = terrain.colors(0), axes = T)
image(x, y, cell, col = terrain.colors(200), axes = T)
image(x, y, cell, col = terrain.colors(100), axes = T)
x <- k/10*(1:nrow(cell));   y <- k/10*(1:ncol(cell))
image(x, y, cell, col = terrain.colors(100), axes = T)
# --- 初期状態の図面
k=1
print("index",k)
print("index"k)
printf("index",k)
paste("index",k,sep="")
eval(paste("index",k,sep=""))
i=3
k=3
index1 <- cell[i,j-1]
index2 <- cell[i,j+1]
index3 <- cell[i-k,j]
index4 <- cell[i+k,j]
index0 <- cell[i,j]
j=3
index1 <- cell[i,j-1]
index2 <- cell[i,j+1]
index3 <- cell[i-k,j]
index4 <- cell[i+k,j]
index0 <- cell[i,j]
index1 <- cell[i,j-1]
index2 <- cell[i,j+1]
index3 <- cell[i-1,j]
index4 <- cell[i+1,j]
index0 <- cell[i,j]
if (index0 == 0 && index1 == 0){
P1 <- 0.5 + 0.5*exp((-myuB - myuC + 2*myuA)/(KB*T))
else {
P1 <- 1
}
}
# --- indexが-1の時
if (index0 == -1){
P1 <- 1
}
# --- indexが-1の時
if (index0 == 1){
P1 <- 1
}
# --- index2
# --- A,Aの時
if (index0 == 0 && index2 == 0){
P2 <- 0.5 + 0.5*exp((-myuB - myuC + 2*myuA)/(KB*T))
else {
P2 <- 1
}
}
# --- indexが-1の時
if (index0 == -1){
P2 <- 1
}
# --- indexが-1の時
if (index0 == 1){
P2 <- 1
}
# --- index3
# --- A,Aの時
if (index0 == 0 && index3 == 0){
P3 <- 0.5 + 0.5*exp((-myuB - myuC + 2*myuA)/(KB*T))
else {
P3 <- 1
}
}
# --- indexが-1の時
if (index0 == -1){
P3 <- 1
}
# --- indexが-1の時
if (index0 == 1){
P3 <- 1
}
# --- index4
# --- A,Aの時
if (index0 == 0 && index4 == 0){
P4 <- 0.5 + 0.5*exp((-myuB - myuC + 2*myuA)/(KB*T))
else {
P4 <- 1
}
}
# --- indexが-1の時
if (index0 == -1){
P4 <- 1
}
# --- indexが-1の時
if (index0 == 1){
P4 <- 1
}
{
if (index0 == 0 && index1 == 0){
P1 <- 0.5 + 0.5*exp((-myuB - myuC + 2*myuA)/(KB*T))
else {
P1 <- 1
}
}
}
if (index0 == 0 && index1 == 0){
P1 <- 0.5 + 0.5*exp((-myuB - myuC + 2*myuA)/(KB*T))
else {
P1 <- 1
}
}
index0=0
if (index0 == 0 && index1 == 0){
P1 <- 0.5 + 0.5*exp((-myuB - myuC + 2*myuA)/(KB*T))
else {
P1 <- 1
}
}
if ((index0 == 0) && (index1 == 0)){
P1 <- 0.5 + 0.5*exp((-myuB - myuC + 2*myuA)/(KB*T))
else {
P1 <- 1
}
}
index1=0
if ((index0 == 0) && (index1 == 0)){
P1 <- 0.5 + 0.5*exp((-myuB - myuC + 2*myuA)/(KB*T))
else {
P1 <- 1
}
}
if ((index0 == 0) && (index1 == 0)){
P1 <- 0.5 + 0.5*exp((-myuB - myuC + 2*myuA)/(KB*T))
else {
if ((index0 == 0) && (index1 == 0)){
P1 <- 0.5 + 0.5*exp((-myuB - myuC + 2*myuA)/(KB*T))
} else {
P1 <- 1
}
KB <- 8.6173303*10^(-5) # eV/K
if ((index0 == 0) && (index1 == 0)){
P1 <- 0.5 + 0.5*exp((-myuB - myuC + 2*myuA)/(KB*T))
} else {
P1 <- 1
}
T <- 100
if ((index0 == 0) && (index1 == 0)){
P1 <- 0.5 + 0.5*exp((-myuB - myuC + 2*myuA)/(KB*T))
} else {
P1 <- 1
}
KB*300
KB*400
if (index0 == 0 && index2 == 0){
P2 <- 0.5 + 0.5*exp((-myuB - myuC + 2*myuA)/(KB*T))
}
else {
P2 <- 1
}
if ((index0 == 0) && (index2 == 0)){
P2 <- 0.5 + 0.5*exp((-myuB - myuC + 2*myuA)/(KB*T))
}
else {
P2 <- 1
}
if ((index0 == 0) && (index2 == 0)){
P2 <- 0.5 + 0.5*exp((-myuB - myuC + 2*myuA)/(KB*T))
} else {
P2 <- 1
}
if (index0 == 0 && index3 == 0){
P3 <- 0.5 + 0.5*exp((-myuB - myuC + 2*myuA)/(KB*T))
} else {
P3 <- 1
}
if (index0 == 0 && index4 == 0){
P4 <- 0.5 + 0.5*exp((-myuB - myuC + 2*myuA)/(KB*T))
} else {
P4 <- 1
}
probability1 <- P1 / (P1 + P2 + P3 + P4)
probability2 <- P2 / (P1 + P2 + P3 + P4)
probability3 <- P3 / (P1 + P2 + P3 + P4)
probability4 <- P4 / (P1 + P2 + P3 + P4)
prob <- data.frame(probability1,probability3,probability3,probability4)
min(prob)
prob
prob <- data.frame(probability1,probability2,probability3,probability4)
prob
min(prob)
prob/min(prob)
probability1+probability2+probability3+probability4
sample(0:1,1)
random(0:1,1)
qnorm(10)
rnorm(10)
rnorm(1)
index1 <- cell[i,j-1]
index2 <- cell[i,j+1]
index3 <- cell[i-1,j]
index4 <- cell[i+1,j]
index0 <- cell[i,j]
# --- 0と周囲のセルの種類による条件分岐
# --- index1
# --- A,Aの時
if ((index0 == 0) && (index1 == 0)){
P1 <- 0.5 + 0.5*exp((-Etotal -myuB - myuC + 2*myuA)/(KB*T))
} else {
P1 <- 1
}
# --- indexが-1の時
if (index0 == -1){
P1 <- 1
}
# --- indexが-1の時
if (index0 == 1){
P1 <- 1
}
# --- index2
# --- A,Aの時
if ((index0 == 0) && (index2 == 0)){
P2 <- 0.5 + 0.5*exp((-Etotal -myuB - myuC + 2*myuA)/(KB*T))
} else {
P2 <- 1
}
# --- indexが-1の時
if (index0 == -1){
P2 <- 1
}
# --- indexが-1の時
if (index0 == 1){
P2 <- 1
}
# --- index3
# --- A,Aの時
if (index0 == 0 && index3 == 0){
P3 <- 0.5 + 0.5*exp((-Etotal -myuB - myuC + 2*myuA)/(KB*T))
} else {
P3 <- 1
}
# --- indexが-1の時
if (index0 == -1){
P3 <- 1
}
# --- indexが-1の時
if (index0 == 1){
P3 <- 1
}
# --- index4
# --- A,Aの時
if (index0 == 0 && index4 == 0){
P4 <- 0.5 + 0.5*exp((-Etotal -myuB - myuC + 2*myuA)/(KB*T))
} else {
P4 <- 1
}
# --- indexが-1の時
if (index0 == -1){
P4 <- 1
}
# --- indexが-1の時
if (index0 == 1){
P4 <- 1
}
probability1 <- P1 / (P1 + P2 + P3 + P4)
probability2 <- P2 / (P1 + P2 + P3 + P4)
probability3 <- P3 / (P1 + P2 + P3 + P4)
probability4 <- P4 / (P1 + P2 + P3 + P4)
# XXX i, jが端っこの時の周期境界条件を設定しないといけない
index1 <- cell[i,j-1]
index2 <- cell[i,j+1]
index3 <- cell[i-1,j]
index4 <- cell[i+1,j]
index0 <- cell[i,j]
# --- 0と周囲のセルの種類による条件分岐
# --- index1
# --- A,Aの時
if ((index0 == 0) && (index1 == 0)){
P1 <- 0.5 + 0.5*exp((-myuB - myuC + 2*myuA)/(KB*T))
} else {
P1 <- 1
}
# --- indexが-1の時
if (index0 == -1){
P1 <- 1
}
# --- indexが-1の時
if (index0 == 1){
P1 <- 1
}
# --- index2
# --- A,Aの時
if ((index0 == 0) && (index2 == 0)){
P2 <- 0.5 + 0.5*exp((-myuB - myuC + 2*myuA)/(KB*T))
} else {
P2 <- 1
}
# --- indexが-1の時
if (index0 == -1){
P2 <- 1
}
# --- indexが-1の時
if (index0 == 1){
P2 <- 1
}
# --- index3
# --- A,Aの時
if (index0 == 0 && index3 == 0){
P3 <- 0.5 + 0.5*exp((-myuB - myuC + 2*myuA)/(KB*T))
} else {
P3 <- 1
}
# --- indexが-1の時
if (index0 == -1){
P3 <- 1
}
# --- indexが-1の時
if (index0 == 1){
P3 <- 1
}
# --- index4
# --- A,Aの時
if (index0 == 0 && index4 == 0){
P4 <- 0.5 + 0.5*exp((-myuB - myuC + 2*myuA)/(KB*T))
} else {
P4 <- 1
}
# --- indexが-1の時
if (index0 == -1){
P4 <- 1
}
# --- indexが-1の時
if (index0 == 1){
P4 <- 1
}
probability1 <- P1 / (P1 + P2 + P3 + P4)
probability2 <- P2 / (P1 + P2 + P3 + P4)
probability3 <- P3 / (P1 + P2 + P3 + P4)
probability4 <- P4 / (P1 + P2 + P3 + P4)
index0=0
index1=0
index2=0
index3=1
index4=-1
if ((index0 == 0) && (index1 == 0)){
P1 <- 0.5 + 0.5*exp((-Etotal -myuB - myuC + 2*myuA)/(KB*T))
} else {
P1 <- 1
}
# --- indexが-1の時
if (index0 == -1){
P1 <- 1
}
# --- indexが-1の時
if (index0 == 1){
P1 <- 1
}
# --- index2
# --- A,Aの時
if ((index0 == 0) && (index2 == 0)){
P2 <- 0.5 + 0.5*exp((-Etotal -myuB - myuC + 2*myuA)/(KB*T))
} else {
P2 <- 1
}
# --- indexが-1の時
if (index0 == -1){
P2 <- 1
}
# --- indexが-1の時
if (index0 == 1){
P2 <- 1
}
# --- index3
# --- A,Aの時
if (index0 == 0 && index3 == 0){
P3 <- 0.5 + 0.5*exp((-Etotal -myuB - myuC + 2*myuA)/(KB*T))
} else {
P3 <- 1
}
# --- indexが-1の時
if (index0 == -1){
P3 <- 1
}
# --- indexが-1の時
if (index0 == 1){
P3 <- 1
}
# --- index4
# --- A,Aの時
if (index0 == 0 && index4 == 0){
P4 <- 0.5 + 0.5*exp((-Etotal -myuB - myuC + 2*myuA)/(KB*T))
} else {
P4 <- 1
}
# --- indexが-1の時
if (index0 == -1){
P4 <- 1
}
# --- indexが-1の時
if (index0 == 1){
P4 <- 1
}
probability1 <- P1 / (P1 + P2 + P3 + P4)
probability2 <- P2 / (P1 + P2 + P3 + P4)
probability3 <- P3 / (P1 + P2 + P3 + P4)
probability4 <- P4 / (P1 + P2 + P3 + P4)
# --- index1
# --- A,Aの時
if ((index0 == 0) && (index1 == 0)){
P1 <- 0.5 + 0.5*exp((-myuB - myuC + 2*myuA)/(KB*T))
} else {
P1 <- 1
}
# --- indexが-1の時
if (index0 == -1){
P1 <- 1
}
# --- indexが-1の時
if (index0 == 1){
P1 <- 1
}
# --- index2
# --- A,Aの時
if ((index0 == 0) && (index2 == 0)){
P2 <- 0.5 + 0.5*exp((-myuB - myuC + 2*myuA)/(KB*T))
} else {
P2 <- 1
}
# --- indexが-1の時
if (index0 == -1){
P2 <- 1
}
# --- indexが-1の時
if (index0 == 1){
P2 <- 1
}
# --- index3
# --- A,Aの時
if (index0 == 0 && index3 == 0){
P3 <- 0.5 + 0.5*exp((-myuB - myuC + 2*myuA)/(KB*T))
} else {
P3 <- 1
}
# --- indexが-1の時
if (index0 == -1){
P3 <- 1
}
# --- indexが-1の時
if (index0 == 1){
P3 <- 1
}
# --- index4
# --- A,Aの時
if (index0 == 0 && index4 == 0){
P4 <- 0.5 + 0.5*exp((-myuB - myuC + 2*myuA)/(KB*T))
} else {
P4 <- 1
}
# --- indexが-1の時
if (index0 == -1){
P4 <- 1
}
# --- indexが-1の時
if (index0 == 1){
P4 <- 1
}
probability1 <- P1 / (P1 + P2 + P3 + P4)
probability2 <- P2 / (P1 + P2 + P3 + P4)
probability3 <- P3 / (P1 + P2 + P3 + P4)
probability4 <- P4 / (P1 + P2 + P3 + P4)
prob <- data.frame(probability1,probability2,probability3,probability4)
runif(1,min=0,max=1.0000000)
runif(1,min=0,max=1.0000000)
runif(1,min=0,max=1.0000000)
runif(1,min=0,max=1.0000000)
runif(1,min=0,max=1.0000000)
runif(1,min=0,max=1.0000000)
runif(1,min=0,max=1.0000000)
runif(1,min=0,max=1.0000000)
runif(1,min=0,max=1.0)
